<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <title>Detección Cáncer de Mama</title>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar navbar-dark bg-dark">

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item active">
                    <a class="nav-link btn btn-outline-info" href="/">Inicio <span class="sr-only">(current)</span></a>
                </li>
                <li class="nav-item active">
                    <a class="nav-link btn btn-outline-success" href="https://app-regresion.herokuapp.com/">Regresion
                        <span class="sr-only">(current)</span></a>
                </li>
            </ul>
    </nav>
    <div class="container">
        <h1 style="text-align: center;">Detección Cáncer de Mama</h1>
        <br>
        <div class="row">
            <div class="col-sm-6">
                <div class="card">
                    <div class="card-body" style="background-image:url(./cancer2.png);">
                        <form>


                            <div class="form row">
                                <div class="form-group col-md-4">
                                    <label for=" Radio media"> Radio media</label>
                                    <input type="number" min=0 class="form-control" id="radiomedia"
                                        placeholder="Radio media" required>
                                </div>
                                <div class="form-group col-md-4">
                                    <label for=" Textura media"> Textura media</label>
                                    <input type="number" min=0 class="form-control" id="texturamedia"
                                        placeholder="Textura media" required>
                                </div>
                                <div class="form-group col-md-4">
                                    <label for="Perimetro media">Perimetro media</label>
                                    <input type="number" min=0 class="form-control" id="perimetromedia"
                                        placeholder="Perimetro" required>
                                </div>
                            </div>

                            <div class="form row">
                                <div class="form-group col-md-4">
                                    <label for="Superficie media "> Superficie media </label>
                                    <input type="number" min=0 class="form-control" id="superficiemedia"
                                        placeholder="Superficie" required>
                                </div>
                                <div class="form-group col-md-4">
                                    <label for=" Suavidad media"> Suavidad media</label>
                                    <input type="number" min=0 class="form-control" id="suavidadmedia"
                                        placeholder="Suavidad" required>
                                </div>
                                <div class="form-group col-md-4">
                                    <label for="Compacidad media"> Compacidad media</label>
                                    <input type="number" min=0 class="form-control" id="compacidadmedia"
                                        placeholder="Compacidad" required>
                                </div>
                            </div>

                            <div class="form row">
                                <div class="form-group col-md-4">
                                    <label for="Concavidad media"> Concavidad media</label>
                                    <input type="number" min=0 class="form-control" id="concavidadmedia"
                                        placeholder="Concavidad" required>
                                </div>
                                <div class="form-group col-md-4">
                                    <label for="Puntos concavos media">Puntos concavos</label>
                                    <input type="number" min=0 class="form-control" id="puntosconcavosmedia"
                                        placeholder="Puntos" required>
                                </div>
                                <div class="form-group col-md-4">
                                    <label for="Simetria media"> Simetria media</label>
                                    <input type="number" min=0 class="form-control" id="simetriamedia"
                                        placeholder="Simetria media" required>
                                </div>
                                <div class="form-group col-md-4">
                                    <label for=" Dimension fractal media"> Dimension fractal</label>
                                    <input type="number" min=0 class="form-control" id="dimensionfractalmedia"
                                        placeholder="Dimension" required>
                                </div>
                                <div class="form-group col-md-4">
                                    <label for=" Radio error"> Radio error</label>
                                    <input type="number" min=0 class="form-control" id="radioerror"
                                        placeholder="Radio error" required>
                                </div>
                                <div class="form-group col-md-4">
                                    <label for=" Textura error"> Textura error</label>
                                    <input type="number" min=0 class="form-control" id="texturaerror"
                                        placeholder="Textura error" required>
                                </div>


                            </div>

                            <!-- variables para error -->

                            <div class="form row">

                                <div class="form-group col-md-4">
                                    <label for="Perimetro error">Perimetro error</label>
                                    <input type="number" min=0 class="form-control" id="perimetroerror"
                                        placeholder="Perimetro" required>
                                </div>

                                <div class="form-group col-md-4">
                                    <label for="Superficie error "> Superficie error </label>
                                    <input type="number" min=0 class="form-control" id="superficieerror"
                                        placeholder="Superficie" required>
                                </div>
                                <div class="form-group col-md-4">
                                    <label for=" Suavidad error"> Suavidad error</label>
                                    <input type="number" min=0 class="form-control" id="suavidaderror"
                                        placeholder="Suavidad" required>
                                </div>
                            </div>



                        </form>
                    </div>
                </div>
            </div>
            <div class="col-sm-6">
                <div class="card">
                    <div class="card-body" style="background-image: url(./cancer2.png);">
                        <div class="form row">

                            <div class="form-group col-md-4">
                                <label for="Compacidad error"> Compacidad error</label>
                                <input type="number" min=0 class="form-control" id="compacidaderror"
                                    placeholder="Compacidad" required>
                            </div>

                            <div class="form-group col-md-4">
                                <label for="Concavidad media"> Concavidad error</label>
                                <input type="number" min=0 class="form-control" id="concavidaderror"
                                    placeholder="Concavidad" required>
                            </div>
                            <div class="form-group col-md-4">
                                <label for="Puntos concavos error">Puntos concavos</label>
                                <input type="number" min=0 class="form-control" id="puntosconcavoserror"
                                    placeholder="Puntos" required>
                            </div>
                        </div>

                        <div class="form row">

                            <div class="form-group col-md-4">
                                <label for="Simetria error"> Simetria error</label>
                                <input type="number" min=0 class="form-control" id="simetriaerror"
                                    placeholder="Simetria error" required>
                            </div>
                            <div class="form-group col-md-4">
                                <label for=" Dimension fractal error"> Dimension fractal</label>
                                <input type="number" min=0 class="form-control" id="dimensionfractalerror"
                                    placeholder="Dimension" required>
                            </div>

                            <div class="form-group col-md-4">
                                <label for=" Radio peor"> Radio peor</label>
                                <input type="number" min=0 class="form-control" id="radiopeor" placeholder="Radio peor"
                                    required>
                            </div>


                        </div>

                        <div class="form row">

                            <div class="form-group col-md-4">
                                <label for=" Textura peor"> Textura peor</label>
                                <input type="number" min=0 class="form-control" id="texturapeor"
                                    placeholder="Textura peor" required>
                            </div>
                            <div class="form-group col-md-4">
                                <label for="Perimetro error">Perimetro peor</label>
                                <input type="number" min=0 class="form-control" id="perimetropeor"
                                    placeholder="Perimetro" required>
                            </div>
                            <div class="form-group col-md-4">
                                <label for="Superficie peor"> Superficie peor </label>
                                <input type="number" min=0 class="form-control" id="superficiepeor"
                                    placeholder="Superficie" required>

                            </div>
                        </div>

                        <div class="form row">

                            <div class="form-group col-md-4">
                                <label for=" Suavidad peor"> Suavidad peor</label>
                                <input type="number" min=0 class="form-control" id="suavidadpeor" placeholder="Suavidad"
                                    required>
                            </div>
                            <div class="form-group col-md-4">
                                <label for="Compacidad peor"> Compacidad peor</label>
                                <input type="number" min=0 class="form-control" id="compacidadpeor"
                                    placeholder="Compacidad" required>
                            </div>

                            <div class="form-group col-md-4">
                                <label for="Concavidad peor"> Concavidad peor</label>
                                <input type="number" min=0 class="form-control" id="concavidadpeor"
                                    placeholder="Concavidad" required>
                            </div>
                        </div>

                        <div class="form row">

                            <div class="form-group col-md-4">
                                <label for="Puntos concavos peor">Puntos concavos</label>
                                <input type="number" min=0 class="form-control" id="puntosconcavospeor"
                                    placeholder="Puntos" required>
                            </div>
                            <div class="form-group col-md-4">
                                <label for="Simetria peor"> Simetria peor</label>
                                <input type="number" min=0 class="form-control" id="simetriapeor"
                                    placeholder="Simetria peor" required>
                            </div>
                            <div class="form-group col-md-4">
                                <label for=" Dimension fractal peor"> Dimension fractal</label>
                                <input type="number" min=0 class="form-control" id="dimensionfractalpeor"
                                    placeholder="Dimension" required>
                            </div>


                        </div>
                    </div>
                </div>
            </div>
        </div>
        <br>
        <div style="display: block; text-align: center;">
            <button class="btn btn-primary" id="predecir" type="button" style="width: 20em;">Predecir</button>
        </div>
        <br>
        <div style="text-align: center; height: 50% ; font-weight: bolder; font: size 100px; color: crimson;"
            id="resultado"></div>


    </div>

    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@2.0.0/dist/tf.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>

    <script type="text/javascript">
        var modelo = null;
        const botonPredecir = document.getElementById("predecir");
        const radiomedia = document.getElementById("radiomedia");
        const texturamedia = document.getElementById("texturamedia");
        const perimetromedia = document.getElementById("perimetromedia");
        const superficiemedia = document.getElementById("superficiemedia");
        const suavidadmedia = document.getElementById("suavidadmedia");
        const compacidadmedia = document.getElementById("compacidadmedia");
        const concavidadmedia = document.getElementById("concavidadmedia");
        const puntosconcavosmedia = document.getElementById("puntosconcavosmedia");
        const simetriamedia = document.getElementById("simetriamedia");
        const dimensionfractalmedia = document.getElementById("dimensionfractalmedia");
        const radioerror = document.getElementById("radioerror");
        const texturaerror = document.getElementById("texturaerror");
        const perimetroerror = document.getElementById("perimetroerror");
        const superficieerror = document.getElementById("superficieerror");
        const suavidaderror = document.getElementById("suavidaderror");
        const compacidaderror = document.getElementById("compacidaderror");
        const concavidaderror = document.getElementById("concavidaderror");
        const puntosconcavoserror = document.getElementById("puntosconcavoserror");
        const simetriaerror = document.getElementById("simetriaerror");
        const dimensionfractalerror = document.getElementById("dimensionfractalerror");
        // variables para el tipo peor
        const radiopeor = document.getElementById("radiopeor");
        const texturapeor = document.getElementById("texturapeor");
        const perimetropeor = document.getElementById("perimetropeor");
        const superficiepeor = document.getElementById("superficiepeor");
        const suavidadpeor = document.getElementById("suavidadpeor");
        const compacidadpeor = document.getElementById("compacidadpeor");
        const concavidadpeor = document.getElementById("concavidadpeor");
        const puntosconcavopeor = document.getElementById("puntosconcavospeor");
        const simetriapeor = document.getElementById("simetriapeor");
        const dimensionfractalpeor = document.getElementById("dimensionfractalpeor");


        (async () => {
            console.log("Cargando modelo...");
            modelo = await tf.loadLayersModel("model.json");
            console.log("Modelo cargado");
        })();


        function Min_MaxScaler(array) {
            let lista_normalizado = []
            let normalizado

            for (var i = 0; i < array.length; i++) {
                normalizado = (array[i] - Math.min(...array)) / (Math.max(...array) - Math.min(...array))
                lista_normalizado[i] = normalizado
            }

            console.log("datos con min-max scaler")
            for (var i = 0; i < lista_normalizado.length; i++) {
                console.log(lista_normalizado[i])
            }

            return lista_normalizado
        }

        function predecir() {
            console.log(modelo)
            if (modelo != null) {
                


                arr = [parseFloat(radiomedia.value), parseFloat(texturamedia.value),
                parseFloat(perimetromedia.value), parseFloat(superficiemedia.value), parseFloat(suavidadmedia.value),
                parseFloat(compacidadmedia.value), parseFloat(concavidadmedia.value), parseFloat(puntosconcavosmedia.value),
                parseFloat(simetriamedia.value), parseFloat(dimensionfractalmedia.value),
                parseFloat(radioerror.value), parseFloat(texturaerror.value),
                parseFloat(perimetroerror.value), parseFloat(superficieerror.value), parseFloat(suavidaderror.value),
                parseFloat(compacidaderror.value), parseFloat(concavidaderror.value), parseFloat(puntosconcavoserror.value),
                parseFloat(simetriaerror.value), parseFloat(dimensionfractalerror.value)
              , parseFloat(radiopeor.value), parseFloat(texturapeor.value),
                parseFloat(perimetropeor.value), parseFloat(superficiepeor.value), parseFloat(suavidadpeor.value),
                parseFloat(compacidadpeor.value), parseFloat(concavidadpeor.value), parseFloat(puntosconcavopeor.value),
                parseFloat(simetriapeor.value), parseFloat(dimensionfractalpeor.value)]
                
                let array_min_max = Min_MaxScaler(arr)
                var tensor = tf.tensor(array_min_max, [1, 30])
                var prediccion = modelo.predict(tensor).dataSync();
                console.log(tensor)
                console.log("prediccion del modelo")
                console.log(prediccion)
                let clase_tipo = 0
                let tipoCancer = ""

                for (let index = 0; index < prediccion.length; index++) {
                    if (prediccion[index] == 1) {
                        clase_tipo = index
                    }

                }

                if (clase_tipo == 0 && prediccion[0] == 1) {
                    tipoCancer = "Benigno"
                } else {
                    tipoCancer = "Maligno"
                }
                console.log(radiomedia.value)
                console.log(texturamedia.value)

                document.getElementById("resultado").innerHTML = "Tipo de Cáncer es " + tipoCancer;
            } else {
                document.getElementById("resultado").innerHTML = "Intenta de nuevo en un momento...";
            }
        }

         botonPredecir.onclick = predecir





    </script>
</body>

</html>